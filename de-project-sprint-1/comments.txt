--datamart_query
	Избавился от UNION.

--orders_view
	Поправил. Очень крутое решение не знал про такое.

--tmp_rfm_frequency/tmp_rfm_recency/tmp_rfm_monetary_value
	Чуть изменил сам скрипт + поменял percentile_disc на nTitle.

--view
	1. CREATE OR REPLACE - поправил
	2. Касательно SELECT *. Согласен с тем что это не самая удачная конструкция с точки зренния оптимизаии.
	Но в задании ничего не сказано про “берите только нужные  для витрины поля” ,я сделал вывод что нужно брать все поля.
	В таком случае что SELECT  *, что перечисление полей ничем не отличается.
	Я бы, например не стал копировать таблицу PRODUCTS т.к. в скрипте она никак не участвует.
------------------------------------------------------------------------------------------------
Привет, поправил код наполнения tmp_rfm_recency; tmp_rfm_frequency; tmp_rfm_monetary_value; dm_rfm_segments.
Действительно такой вариант более элегантнее моего.
Но я не очень понял логику процесса….У нас есть sql скрипт который рассчитывает метрики RFM, далее мы заполняем таблицы  tmp_rfm, а саму витрину собираем из изначального скрипта без участия таблиц tmp_rfm. Зачем нужны таблицы tmp_rfm если они не участвуют в процессе наполнения витрины 
